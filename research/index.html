<body>
  <h1>Welcome to the Mermaid Project</h1>
  <p>This is a test paragraph to ensure the HTML is being displayed correctly.</p>

  <button id="load-uml">Load UML Diagram</button>
  <button id="load-yaml">Load YAML Diagram</button>

  <div id="question"></div>
  <div id="diagram"></div>

  <!-- Include Mermaid JS file from node_modules -->
  <script src="node_modules/mermaid/dist/mermaid.min.js?v=1.0.1"></script>
  <script>
    // Initialize Mermaid
    mermaid.initialize({ startOnLoad: true });

    document.getElementById('load-uml').addEventListener('click', fetchAndRenderUMLContent);
    document.getElementById('load-yaml').addEventListener('click', fetchAndRenderYAMLContent);

    // Function to fetch and render UML content
    async function fetchAndRenderUMLContent() {
      try {
        const response = await fetch('http://127.0.0.1:5000/convert_file');
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const data = await response.json();
        if (data.error) {
          throw new Error(data.error);
        }

        // Display the question content
        document.getElementById('question').innerHTML = `<p>${data.question}</p>`;

        // Display the Mermaid diagram
        document.getElementById('diagram').innerHTML = `<div class="mermaid">${data.mermaid_code}</div>`;
        mermaid.init(undefined, document.querySelectorAll('.mermaid'));
      } catch (error) {
        console.error('Error fetching and rendering UML content:', error);
      }
    }

    // Function to fetch and render YAML content
    async function fetchAndRenderYAMLContent() {
      try {
        const response = await fetch('http://127.0.0.1:5000/convert_yaml_file');
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const data = await response.json();
        if (data.error) {
          throw new Error(data.error);
        }

        // Display the YAML conversion result as a Mermaid diagram
        document.getElementById('diagram').innerHTML = `<div class="mermaid">${data.mermaid_code}</div>`;
        mermaid.init(undefined, document.querySelectorAll('.mermaid'));
      } catch (error) {
        console.error('Error fetching and rendering YAML content:', error);
      }
    }
  </script>
</body>
