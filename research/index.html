<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mermaid Project</title>
  <!-- Include Mermaid CSS file -->
  <link rel="stylesheet" href="src/mermaid.css">
  <!-- Link to favicon -->
  <link rel="icon" href="src/favicon.ico" type="image/x-icon">
</head>
<body>
  <h1>Welcome to the Mermaid Project</h1>
  <p>This is a test paragraph to ensure the HTML is being displayed correctly.</p>

  <div id="diagram"></div>

  <!-- Include Mermaid JS file from node_modules -->
  <script src="node_modules/mermaid/dist/mermaid.min.js"></script>
  <!-- Include marked.js library -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- Include other JS files from src -->
  <script src="src/grapher.js"></script>
  <script src="src/renderer.js"></script>
  <script src="src/index.js"></script>
  <!-- Include Fetching and Rendering Script -->
  <script>
    // Initialize Mermaid
    mermaid.initialize({ startOnLoad: true });

    // Function to fetch and render the Markdown file content
    async function fetchAndRenderMarkdown() {
      try {
        const response = await fetch('src/diagram.md');
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        const text = await response.text();
        console.log('Fetched Markdown content:', text);

        // Parse the Markdown content to HTML
        const htmlContent = marked.parse(text);
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = htmlContent;

        // Find Mermaid code blocks and transform them
        const mermaidBlocks = tempDiv.querySelectorAll('code.language-mermaid');
        mermaidBlocks.forEach(block => {
          const mermaidDiv = document.createElement('div');
          mermaidDiv.classList.add('mermaid');
          mermaidDiv.textContent = block.textContent;
          block.replaceWith(mermaidDiv);
        });

        // Append the parsed content to the diagram div
        document.getElementById('diagram').appendChild(tempDiv);

        // Initialize Mermaid for any found Mermaid code blocks
        mermaid.init(undefined, document.querySelectorAll('.mermaid'));
      } catch (error) {
        console.error('Error fetching the Markdown file:', error);
      }
    }

    // Call the function to fetch and render the Markdown content
    fetchAndRenderMarkdown();
  </script>
</body>
</html>
